@using SasquatchCAIRS
@using SasquatchCAIRS.Controllers.Security
@using SasquatchCAIRS.Models
@model IQueryable<UserProfile>
@{
    ViewBag.Title = Constants.UIString.TitleText.ADMIN + " - " + Constants.UIString.TitleText.USERS;
}

<h2>@Constants.UIString.TitleText.ADMIN - @Constants.UIString.TitleText.USERS</h2>

@if (Model != null) {
<table class="table table-hover">
    <tr>
        <th>@Constants.UIString.FieldLabel.USERNAME</th>
        <th>@Constants.UIString.FieldLabel.FULL_NAME</th>
        <th>@Constants.UIString.FieldLabel.ROLES</th>
        <th>@Constants.UIString.FieldLabel.GROUPS</th>
    </tr>
    @foreach (UserProfile user in Model) {
        <tr>
            <td class="clickable" data-id="@user.UserId">@user.UserName</td>
            <td class="clickable" data-id="@user.UserId">@user.UserFullName</td>
            <td class="clickable" data-id="@user.UserId">@foreach(string role in Roles.GetRolesForUser(user.UserName)) { <span>@role</span><br /> }</td>
            <td class="clickable" data-id="@user.UserId">@foreach(UserGroup group in (new UserController()).getUserGroups(user.UserName)) { <span>@group.Code - @group.Value</span><br /> }</td>
        </tr>
    }
</table>
}

<script type="text/javascript">
    $(function() {
        $(".clickable").click(function() {
            document.location.href = "/Admin/User/" + $(this).attr("data-id");
            document.location.href = "/Admin/UserDetails/" + $(this).attr("data-id");
        });
    })
</script>
